Тест-кейсы для выпадающего списка страны и кода телефона

TC-01: Полный список и сортировка  
Предусловие: Страница открыта, dropdown загружен.  
Шаги:  
1. Открыть dropdown  
   Ожидаемый результат: Список отображается полностью, с флагами и кодами, в алфавитном порядке.  
2. Проверить первую и последнюю запись  
   Ожидаемый результат: Первая и последняя страны отображают правильный код и флаг.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-02: Уникальность кодов  
Предусловие: Dropdown открыт.  
Шаги:  
1. Просмотреть все телефонные коды в списке  
   Ожидаемый результат: Нет повторяющихся кодов.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-03: Фильтрация по названию ("Ru")  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести "Ru" в поле поиска  
   Ожидаемый результат: Список фильтруется.  
2. Проверить результат  
   Ожидаемый результат: Отображается только "Россия".  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт, поле поиска очищено.

TC-04: Фильтрация по коду ("+1")  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести "+1" в поле поиска  
   Ожидаемый результат: Список фильтруется.  
2. Проверить результат  
   Ожидаемый результат: Показаны все страны с кодом +1.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт, поле поиска очищено.

TC-05: Нет совпадений ("XYZ")  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести "XYZ" в поле поиска  
   Ожидаемый результат: Появляется сообщение "Ничего не найдено".  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт, поле поиска очищено.

TC-06: Спецсимволы ("!@#")  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести "!@#" в поле поиска  
   Ожидаемый результат: Появляется сообщение "Ничего не найдено".  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт, поле поиска очищено.

TC-07: Выбор мышью  
Предусловие: Dropdown открыт.  
Шаги:  
1. Кликнуть по третьему элементу списка  
   Ожидаемый результат: В поле отображается выбранная страна и код.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-08: Выбор клавиатурой  
Предусловие: Dropdown доступен.  
Шаги:  
1. Нажать Tab  
   Ожидаемый результат: Фокус установлен на dropdown.  
2. Нажать стрелку вниз 3 раза  
   Ожидаемый результат: Подсвечен 4-й элемент.  
3. Нажать Enter  
   Ожидаемый результат: В поле отображается выбранная страна с кодом.  
4. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-09: Закрытие без выбора  
Предусловие: Dropdown открыт.  
Шаги:  
1. Нажать Esc  
   Ожидаемый результат: Dropdown закрыт, значение не изменилось.  
2. Открыть dropdown и кликнуть вне  
   Ожидаемый результат: Dropdown закрыт.

TC-10: Сохранение после перезагрузки  
Предусловие: Dropdown доступен.  
Шаги:  
1. Выбрать страну  
   Ожидаемый результат: Поле заполнено выбранным значением.  
2. Перезагрузить страницу  
   Ожидаемый результат: Выбор сохраняется.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-11: Сброс кнопкой  
Предусловие: Страна выбрана.  
Шаги:  
1. Нажать кнопку "Сброс"  
   Ожидаемый результат: Поле очищено или вернулось на дефолт.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-12: ARIA-атрибуты  
Предусловие: Dropdown доступен.  
Шаги:  
1. Проверить наличие aria-haspopup="listbox"  
   Ожидаемый результат: Атрибут присутствует.  
2. Открыть dropdown  
   Ожидаемый результат: aria-expanded="true".  
3. Закрыть dropdown  
   Ожидаемый результат: aria-expanded="false", dropdown закрыт.

TC-13: Масштабирование и адаптивность  
Предусловие: Страница доступна.  
Шаги:  
1. Установить масштаб 200%  
   Ожидаемый результат: Dropdown остаётся читаемым и доступным.  
2. Изменить ширину экрана до 360px  
   Ожидаемый результат: Элементы списка видны и не обрезаются.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-14: Локализация и RTL  
Предусловие: Интерфейс на английском.  
Шаги:  
1. Переключить на арабский (ar)  
   Ожидаемый результат: Список выровнен справа, сортировка по арабскому.  
2. Переключить на испанский (es-ES)  
   Ожидаемый результат: Названия стран на испанском.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-15: Debounce при вводе  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести символ  
   Ожидаемый результат: API-запрос произойдёт через 300 мс.  
2. Ввести следующий символ через 100 мс  
   Ожидаемый результат: Новый запрос отложен до 300 мс после последнего ввода.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-16: Ленивая подгрузка  
Предусловие: Dropdown открыт.  
Шаги:  
1. Прокрутить до конца списка  
   Ожидаемый результат: Загрузка новых элементов.  
2. Прокрутить ещё раз  
   Ожидаемый результат: Появляются дополнительные элементы, без дублирования.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-17: Защита от XSS  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести `<script>alert(1)</script>`  
   Ожидаемый результат: Тег выводится как текст, скрипт не выполняется.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-18: Защита от SQL-инъекции  
Предусловие: Dropdown открыт.  
Шаги:  
1. Ввести `100'; DROP TABLE users;--`  
   Ожидаемый результат: Появляется сообщение об ошибке, БД не изменена.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-19: История последних выборов  
Предусловие: Dropdown открыт.  
Шаги:  
1. Последовательно выбрать 5 разных стран  
   Ожидаемый результат: Появляется секция "Последние выборы" с этими странами.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-20: Событие аналитики  
Предусловие: Инструмент аналитики активирован.  
Шаги:  
1. Выбрать страну  
   Ожидаемый результат: В логах появляется событие country_selected с правильным кодом.  
2. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.

TC-21: WebSocket-обновление  
Предусловие: Dropdown открыт, WebSocket подключён.  
Шаги:  
1. Эмулировать добавление страны (например, Narnia +999)  
   Ожидаемый результат: Её видно в списке.  
2. Выбрать эту страну  
   Ожидаемый результат: В поле отражается Narnia +999.  
3. Закрыть dropdown  
   Ожидаемый результат: Dropdown закрыт.
